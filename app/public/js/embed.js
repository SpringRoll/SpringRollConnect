!function(a){function b(a){var b={},c=a.split("&");for(var d in c){var e=c[d].split("=");b[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return b}var c=include("springroll.Container"),d=(include("springroll.Features"),include("springroll.SavedData")),e=include("pbskids.Tracker"),f=function(){c.call(this,"#appContainer",{helpButton:"#helpButton",captionsButton:"#captionsButton",soundButton:"#soundButton",voButton:"#voButton",sfxButton:"#sfxButton",musicButton:"#musicButton",pauseButton:"#pauseButton, #resumeButton"}),this.frame=$("#frame"),this.on({learningEvent:k.bind(this),analyticEvent:j.bind(this),open:p.bind(this),opened:q.bind(this),pause:o.bind(this),helpEnabled:n.bind(this),closed:r.bind(this),features:m.bind(this),unsupported:function(){alert("Your current web browser doesn't support this games features.")},remoteFailed:function(){alert("Invalid API request")},remoteError:function(a){alert(a)}}),$("form").submit(function(a){return!1}),this.tracker=new e,this.tracker.setEnabled(!1),this.appTitle=$("#appTitle"),this.release=null,this.remoteConnect=$("#remoteConnect").click(this.connectLoggingService.bind(this)),this.captionsToggle=$("#captionsToggle"),this.soundToggle=$("#soundToggle"),this.settingsButton=$("#settingsButton"),this.remoteHost=$("#remoteHost").val(d.read("remoteHost")),this.remoteChannel=$("#remoteChannel");var a=this.dropdowns=$(".drop-down");this.toggles=$("button[data-toggle-div]").each(function(){var b=$(this),c=b.data("toggle-div"),d=$(c);b.on("click hover",function(b){var c=d.hasClass("on");a.removeClass("on"),c||d.addClass("on")})}),$("#captionsStyles select").change(l.bind(this));var f=this.getCaptionsStyles();$("select[name='color']").val(f.color),$("select[name='background']").val(f.background),$("select[name='align']").val(f.align),$("select[name='font']").val(f.font),$("select[name='size']").val(f.size),$("select[name='edge']").val(f.edge),h=document.title,Modernizr.touch||($('[data-toggle="tooltip"]').tooltip(i),this.helpEnabled=!1),$(document).on("selectstart",!1);var g=location.pathname.replace("/embed/","/api/release/");if(location.search){var s=b(location.search.substr(1)),t=[];s.token&&t.push("token="+s.token),s.debug&&t.push("debug=true"),s.controls&&this.frame.addClass("show-controls"),s.title&&this.frame.addClass("show-title"),t.length&&(g+="?"+t.join("&"))}this.openRemote(g)},g=extend(f,c),h="",i={placement:"bottom"},j=function(a){this.tracker.remoteSend("ga-event",a)},k=function(a){this.tracker.pushEvent(a)},l=function(a){var b=a.currentTarget;this.setCaptionsStyles(b.name,b.value)},m=function(a){this.captionsToggle.hide(),this.soundToggle.hide(),this.settingsButton.hide(),a.captions&&this.captionsToggle.show(),a.sound&&this.soundToggle.show(),a.learning&&this.settingsButton.show()};g.connectLoggingService=function(){var a=this.remoteHost.val(),b=this.remoteChannel.val();d.write("remoteHost",a),a&&this.tracker.remoteConnect(a),b&&this.tracker.remoteChannel(b)};var n=function(a){if(!Modernizr.touch){var b=this.helpButton;a?b.tooltip(i):b.tooltip("destroy")}},o=function(a){this.frame.removeClass("paused"),a&&this.frame.addClass("paused")},p=function(){var a=this.release;this.remoteChannel.val(a.game.slug),this.connectLoggingService(),this.dropdowns.removeClass("on"),this.toggles.addClass("disabled"),this.frame.addClass("loading"),this.appTitle.text(a.game.title),document.title=a.game.title+" | "+h},q=function(){this.frame.removeClass("loading"),this.toggles.removeClass("disabled"),this.paused=!1},r=function(){this.dropdowns.removeClass("on"),this.toggles.addClass("disabled"),document.title=h};namespace("pbskids").Embed=f,window.app=new f}();